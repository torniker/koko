<link rel="import" href="/bower_components/iron-ajax/iron-ajax.html">
<link rel="import" href="/elements/molecules/copy-to-clipboard.html">
<dom-module id="user-info">
<template>
    <style>
        .jumbotron {
            margin-top: -30px;
        }
    </style>
    <iron-ajax
            auto
            url="{{ url }}"
            params=""
            handleAs="json"
            on-response="handleResponse"
            method='GET'>
    </iron-ajax>
    <div class="jumbotron">
        <div class="container">
            <h1>
                <i class="fa fa-server"></i>
                User Info
            </h1>
            <p>
                Know your IP and User Agent. You deserve this.
            </p>
        </div>
    </div>
    <div class="container">
        <div class="row">
            <div class="col-xs-12 col-md-4 text-center">
                <h3>
                    IP Address
                </h3>
                <div class="input-group">
                    <input id="ipInput" class="form-control input-lg text-center" value="{{ data.ip::input }}" readonly>
                    <span class="input-group-btn">
                        <copy-to-clipboard value="{{ data.ip }}"></copy-to-clipboard>
                    </span>
                </div>
            </div>
            <div class="col-xs-12 col-md-8 text-center">
                <h3>
                    User Agent
                </h3>
                <div class="input-group">
                    <input id="userAgentInput" class="form-control input-lg text-center" value="{{ data.userAgent::input }}" readonly>
                    <span class="input-group-btn">
                        <copy-to-clipboard value="{{ data.userAgent }}"></copy-to-clipboard>
                    </span>
                </div>
            </div>
        </div>
    </div>
</template>
<script>
    Polymer({
        is: "user-info",
        properties: {
            url: { 
                type: String,
                value: '/api/user-info'
            },
            data: {
                type: Object
            },
            test: {
                type: String,
                value: ''
            }
        },
        ready: function() {
            this.$.ipInput.addEventListener('focus', this.onFocus);
            this.$.userAgentInput.addEventListener('focus', this.onFocus);
        },
        onFocus: function() {
            this.setSelectionRange(0,this.value.length);
        },
        handleResponse: function(e, ajax) {
            this.data = ajax.response;
        }
    });
</script>
</dom-module>